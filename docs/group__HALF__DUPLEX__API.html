<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tiny protocol: Tiny Half Duplex API functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tiny protocol
   &#160;<span id="projectnumber">0.9.3</span>
   </div>
   <div id="projectbrief">Tiny communication protocol for microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Tiny Half Duplex API functions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSTinyHdData__.html">STinyHdData_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSTinyHdInit__.html">STinyHdInit_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTiny_1_1ProtoHd.html">Tiny::ProtoHd</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaf9f81ad129b754a780dfca5dcd7f7cf9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSTinyHdData__.html">STinyHdData_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a></td></tr>
<tr class="separator:gaf9f81ad129b754a780dfca5dcd7f7cf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga784f1a0f0ae7f06da4bc288fa3f22408"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSTinyHdInit__.html">STinyHdInit_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#ga784f1a0f0ae7f06da4bc288fa3f22408">STinyHdInit</a></td></tr>
<tr class="separator:ga784f1a0f0ae7f06da4bc288fa3f22408"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga747e6a3a0b5d2a9e1fe0c143c20057e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#ga747e6a3a0b5d2a9e1fe0c143c20057e9">tiny_hd_init</a> (<a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *handle, <a class="el" href="group__HALF__DUPLEX__API.html#ga784f1a0f0ae7f06da4bc288fa3f22408">STinyHdInit</a> *init)</td></tr>
<tr class="memdesc:ga747e6a3a0b5d2a9e1fe0c143c20057e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialized communication for Tiny Half Duplex protocol.  <a href="#ga747e6a3a0b5d2a9e1fe0c143c20057e9">More...</a><br /></td></tr>
<tr class="separator:ga747e6a3a0b5d2a9e1fe0c143c20057e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga275846730a88b9654345d5defbda31e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#ga275846730a88b9654345d5defbda31e7">tiny_hd_close</a> (<a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *handle)</td></tr>
<tr class="memdesc:ga275846730a88b9654345d5defbda31e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">stops Tiny Half Duplex state machine  <a href="#ga275846730a88b9654345d5defbda31e7">More...</a><br /></td></tr>
<tr class="separator:ga275846730a88b9654345d5defbda31e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac962595f09883dea1dd0992a608a17b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#gac962595f09883dea1dd0992a608a17b9">tiny_hd_run</a> (<a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *handle)</td></tr>
<tr class="memdesc:gac962595f09883dea1dd0992a608a17b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">runs receive functions of Tiny Half Duplex protocol.  <a href="#gac962595f09883dea1dd0992a608a17b9">More...</a><br /></td></tr>
<tr class="separator:gac962595f09883dea1dd0992a608a17b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga84325cc961c3f31e2ba6111d0235bd61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#ga84325cc961c3f31e2ba6111d0235bd61">tiny_hd_run_tx</a> (<a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *handle)</td></tr>
<tr class="separator:ga84325cc961c3f31e2ba6111d0235bd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5aad8dcb504b80bac923496f2686a6d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__HALF__DUPLEX__API.html#ga5aad8dcb504b80bac923496f2686a6d6">tiny_send_wait_ack</a> (<a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *handle, void *buf, uint16_t len)</td></tr>
<tr class="memdesc:ga5aad8dcb504b80bac923496f2686a6d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends userdata and waits for acknowledgement from remote side.  <a href="#ga5aad8dcb504b80bac923496f2686a6d6">More...</a><br /></td></tr>
<tr class="separator:ga5aad8dcb504b80bac923496f2686a6d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gaf9f81ad129b754a780dfca5dcd7f7cf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9f81ad129b754a780dfca5dcd7f7cf9">&#9670;&nbsp;</a></span>STinyHdData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSTinyHdData__.html">STinyHdData_</a>  <a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This structure contains service data, required for half-duplex functioning. </p>

</div>
</div>
<a id="ga784f1a0f0ae7f06da4bc288fa3f22408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga784f1a0f0ae7f06da4bc288fa3f22408">&#9670;&nbsp;</a></span>STinyHdInit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSTinyHdInit__.html">STinyHdInit_</a>  <a class="el" href="group__HALF__DUPLEX__API.html#ga784f1a0f0ae7f06da4bc288fa3f22408">STinyHdInit</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This structure is used for initialization of Tiny Half Duplex protocol. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga275846730a88b9654345d5defbda31e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga275846730a88b9654345d5defbda31e7">&#9670;&nbsp;</a></span>tiny_hd_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiny_hd_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stops Tiny Half Duplex state machine </p>
<p>stops Tiny Half Duplex state machine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>- pointer to STinyHdData </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga747e6a3a0b5d2a9e1fe0c143c20057e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga747e6a3a0b5d2a9e1fe0c143c20057e9">&#9670;&nbsp;</a></span>tiny_hd_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiny_hd_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HALF__DUPLEX__API.html#ga784f1a0f0ae7f06da4bc288fa3f22408">STinyHdInit</a> *&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialized communication for Tiny Half Duplex protocol. </p>
<p>The function initializes internal structures for Tiny Half Duplex state machine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>- pointer to Tiny Half Duplex data </td></tr>
    <tr><td class="paramname">init</td><td>- pointer to STinyHdInit data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TINY_NO_ERROR in case of success. TINY_ERR_FAILED if init parameters are incorrect. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is not thread safe. </dd></dl>

</div>
</div>
<a id="gac962595f09883dea1dd0992a608a17b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac962595f09883dea1dd0992a608a17b9">&#9670;&nbsp;</a></span>tiny_hd_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiny_hd_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>runs receive functions of Tiny Half Duplex protocol. </p>
<p>Runs receive functions of Tiny Half Duplex protocol. This function must be called all the time in the loop if send operation is not performed. For atmega controllers this means to call <a class="el" href="group__HALF__DUPLEX__API.html#gac962595f09883dea1dd0992a608a17b9" title="runs receive functions of Tiny Half Duplex protocol. ">tiny_hd_run()</a> in loop() routine. If user packet is received during execution of the function, it wil call on_frame_cb_t callback to process received packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>- pointer to STinyHdData </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__ERROR__FLAGS.html#ga84e6ca143550038e1a71cf36078d1926" title="Timeout. ">TINY_ERR_FAILED</a> </dd>
<dd>
<a class="el" href="group__ERROR__FLAGS.html#ga7bbe7440d11ad304b0af68e011f4eab7" title="Data too large to fit the user buffer. ">TINY_ERR_DATA_TOO_LARGE</a> </dd>
<dd>
<a class="el" href="group__ERROR__FLAGS.html#gae1949de45d9c478830dad9c9b996193a" title="Out of sync - received some data, which are not part of the frame (tiny_read) ">TINY_ERR_OUT_OF_SYNC</a> </dd>
<dd>
<a class="el" href="group__ERROR__FLAGS.html#ga9b3e170e1c6ce269f216ef4a1ac61995" title="API function detected that operation cannot be performed right now. ">TINY_ERR_BUSY</a> </dd>
<dd>
TINY_NO_ERROR </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>TINY_ERR_OUT_OF_SYNC - if first byte received from the channel is not packet marker. You may ignore this error. TINY_ERR_DATA_TOO_LARGE - if incoming packet is too large to fit the buffer TINY_ERR_FAILED - if something wrong with received data TINY_BUSY - if another receive operation is in progress. TINY_SUCCESS - if nothing is received. greater 0 - number of received bytes. Callbak will be called in this case. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>do not use blocking send (tiny_send_wait_ack) in on_frame_cb_t callback. </dd></dl>

</div>
</div>
<a id="ga84325cc961c3f31e2ba6111d0235bd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga84325cc961c3f31e2ba6111d0235bd61">&#9670;&nbsp;</a></span>tiny_hd_run_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiny_hd_run_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Use this function for multithread mode, when you need to run tx in separate thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>- pointer to STinyHdData </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TINY_ERR_FAILED - if something wrong with received data TINY_SUCCESS - if nothing is received. </dd></dl>

</div>
</div>
<a id="ga5aad8dcb504b80bac923496f2686a6d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5aad8dcb504b80bac923496f2686a6d6">&#9670;&nbsp;</a></span>tiny_send_wait_ack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiny_send_wait_ack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HALF__DUPLEX__API.html#gaf9f81ad129b754a780dfca5dcd7f7cf9">STinyHdData</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends userdata and waits for acknowledgement from remote side. </p>
<p>Sends userdata and waits for acknowledgement from remote side.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Each outoing packet is assigned 16-bit uid, and remote side must confirm with service packet sent back with this 16-bit uid. Generated uids have range in [0 : 0x0FFF]. Higher 4 bits of uid field are used to pass flags with the packet.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>- pointer to STinyHdData </td></tr>
    <tr><td class="paramname">buf</td><td>- data to send </td></tr>
    <tr><td class="paramname">len</td><td>- length of data to send</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of bytes, sent. TINY_ERR_TIMEOUT - if no response from remote side after 3 retries. TINY_ERR_FAILED - if request was cancelled, by <a class="el" href="group__HALF__DUPLEX__API.html#ga275846730a88b9654345d5defbda31e7" title="stops Tiny Half Duplex state machine ">tiny_hd_close()</a>. other error codes - if send/receive errors happened. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
