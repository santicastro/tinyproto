\hypertarget{group__HALF__DUPLEX__API}{}\section{Tiny Half Duplex A\+PI functions}
\label{group__HALF__DUPLEX__API}\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structSTinyHdData__}{S\+Tiny\+Hd\+Data\+\_\+}
\item 
struct \hyperlink{structSTinyHdInit__}{S\+Tiny\+Hd\+Init\+\_\+}
\item 
class \hyperlink{classTiny_1_1ProtoHd}{Tiny\+::\+Proto\+Hd}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structSTinyHdData__}{S\+Tiny\+Hd\+Data\+\_\+} \hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data}
\item 
typedef struct \hyperlink{structSTinyHdInit__}{S\+Tiny\+Hd\+Init\+\_\+} \hyperlink{group__HALF__DUPLEX__API_ga784f1a0f0ae7f06da4bc288fa3f22408}{S\+Tiny\+Hd\+Init}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__HALF__DUPLEX__API_ga747e6a3a0b5d2a9e1fe0c143c20057e9}{tiny\+\_\+hd\+\_\+init} (\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$handle, \hyperlink{group__HALF__DUPLEX__API_ga784f1a0f0ae7f06da4bc288fa3f22408}{S\+Tiny\+Hd\+Init} $\ast$init)
\begin{DoxyCompactList}\small\item\em Initialized communication for Tiny Half Duplex protocol. \end{DoxyCompactList}\item 
void \hyperlink{group__HALF__DUPLEX__API_ga275846730a88b9654345d5defbda31e7}{tiny\+\_\+hd\+\_\+close} (\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$handle)
\begin{DoxyCompactList}\small\item\em stops Tiny Half Duplex state machine \end{DoxyCompactList}\item 
int \hyperlink{group__HALF__DUPLEX__API_gac962595f09883dea1dd0992a608a17b9}{tiny\+\_\+hd\+\_\+run} (\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$handle)
\begin{DoxyCompactList}\small\item\em runs receive functions of Tiny Half Duplex protocol. \end{DoxyCompactList}\item 
int \hyperlink{group__HALF__DUPLEX__API_ga84325cc961c3f31e2ba6111d0235bd61}{tiny\+\_\+hd\+\_\+run\+\_\+tx} (\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$handle)
\item 
int \hyperlink{group__HALF__DUPLEX__API_ga5aad8dcb504b80bac923496f2686a6d6}{tiny\+\_\+send\+\_\+wait\+\_\+ack} (\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$handle, void $\ast$buf, uint16\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Sends userdata and waits for acknowledgement from remote side. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Typedef Documentation}
\mbox{\Hypertarget{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}\label{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!S\+Tiny\+Hd\+Data@{S\+Tiny\+Hd\+Data}}
\index{S\+Tiny\+Hd\+Data@{S\+Tiny\+Hd\+Data}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{S\+Tiny\+Hd\+Data}{STinyHdData}}
{\footnotesize\ttfamily typedef struct \hyperlink{structSTinyHdData__}{S\+Tiny\+Hd\+Data\+\_\+}  \hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data}}

This structure contains service data, required for half-\/duplex functioning. \mbox{\Hypertarget{group__HALF__DUPLEX__API_ga784f1a0f0ae7f06da4bc288fa3f22408}\label{group__HALF__DUPLEX__API_ga784f1a0f0ae7f06da4bc288fa3f22408}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!S\+Tiny\+Hd\+Init@{S\+Tiny\+Hd\+Init}}
\index{S\+Tiny\+Hd\+Init@{S\+Tiny\+Hd\+Init}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{S\+Tiny\+Hd\+Init}{STinyHdInit}}
{\footnotesize\ttfamily typedef struct \hyperlink{structSTinyHdInit__}{S\+Tiny\+Hd\+Init\+\_\+}  \hyperlink{group__HALF__DUPLEX__API_ga784f1a0f0ae7f06da4bc288fa3f22408}{S\+Tiny\+Hd\+Init}}

This structure is used for initialization of Tiny Half Duplex protocol. 

\subsection{Function Documentation}
\mbox{\Hypertarget{group__HALF__DUPLEX__API_ga275846730a88b9654345d5defbda31e7}\label{group__HALF__DUPLEX__API_ga275846730a88b9654345d5defbda31e7}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!tiny\+\_\+hd\+\_\+close@{tiny\+\_\+hd\+\_\+close}}
\index{tiny\+\_\+hd\+\_\+close@{tiny\+\_\+hd\+\_\+close}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{tiny\+\_\+hd\+\_\+close()}{tiny\_hd\_close()}}
{\footnotesize\ttfamily void tiny\+\_\+hd\+\_\+close (\begin{DoxyParamCaption}\item[{\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$}]{handle }\end{DoxyParamCaption})}



stops Tiny Half Duplex state machine 

stops Tiny Half Duplex state machine.


\begin{DoxyParams}{Parameters}
{\em handle} & -\/ pointer to S\+Tiny\+Hd\+Data \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{group__HALF__DUPLEX__API_ga747e6a3a0b5d2a9e1fe0c143c20057e9}\label{group__HALF__DUPLEX__API_ga747e6a3a0b5d2a9e1fe0c143c20057e9}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!tiny\+\_\+hd\+\_\+init@{tiny\+\_\+hd\+\_\+init}}
\index{tiny\+\_\+hd\+\_\+init@{tiny\+\_\+hd\+\_\+init}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{tiny\+\_\+hd\+\_\+init()}{tiny\_hd\_init()}}
{\footnotesize\ttfamily int tiny\+\_\+hd\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$}]{handle,  }\item[{\hyperlink{group__HALF__DUPLEX__API_ga784f1a0f0ae7f06da4bc288fa3f22408}{S\+Tiny\+Hd\+Init} $\ast$}]{init }\end{DoxyParamCaption})}



Initialized communication for Tiny Half Duplex protocol. 

The function initializes internal structures for Tiny Half Duplex state machine.


\begin{DoxyParams}{Parameters}
{\em handle} & -\/ pointer to Tiny Half Duplex data \\
\hline
{\em init} & -\/ pointer to S\+Tiny\+Hd\+Init data. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+I\+N\+Y\+\_\+\+N\+O\+\_\+\+E\+R\+R\+OR in case of success. T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+F\+A\+I\+L\+ED if init parameters are incorrect. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
This function is not thread safe. 
\end{DoxyRemark}
\mbox{\Hypertarget{group__HALF__DUPLEX__API_gac962595f09883dea1dd0992a608a17b9}\label{group__HALF__DUPLEX__API_gac962595f09883dea1dd0992a608a17b9}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!tiny\+\_\+hd\+\_\+run@{tiny\+\_\+hd\+\_\+run}}
\index{tiny\+\_\+hd\+\_\+run@{tiny\+\_\+hd\+\_\+run}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{tiny\+\_\+hd\+\_\+run()}{tiny\_hd\_run()}}
{\footnotesize\ttfamily int tiny\+\_\+hd\+\_\+run (\begin{DoxyParamCaption}\item[{\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$}]{handle }\end{DoxyParamCaption})}



runs receive functions of Tiny Half Duplex protocol. 

Runs receive functions of Tiny Half Duplex protocol. This function must be called all the time in the loop if send operation is not performed. For atmega controllers this means to call \hyperlink{group__HALF__DUPLEX__API_gac962595f09883dea1dd0992a608a17b9}{tiny\+\_\+hd\+\_\+run()} in loop() routine. If user packet is received during execution of the function, it wil call on\+\_\+frame\+\_\+cb\+\_\+t callback to process received packet.


\begin{DoxyParams}{Parameters}
{\em handle} & -\/ pointer to S\+Tiny\+Hd\+Data \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__ERROR__FLAGS_ga84e6ca143550038e1a71cf36078d1926}{T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+F\+A\+I\+L\+ED} 

\hyperlink{group__ERROR__FLAGS_ga7bbe7440d11ad304b0af68e011f4eab7}{T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+D\+A\+T\+A\+\_\+\+T\+O\+O\+\_\+\+L\+A\+R\+GE} 

\hyperlink{group__ERROR__FLAGS_gae1949de45d9c478830dad9c9b996193a}{T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+O\+U\+T\+\_\+\+O\+F\+\_\+\+S\+Y\+NC} 

\hyperlink{group__ERROR__FLAGS_ga9b3e170e1c6ce269f216ef4a1ac61995}{T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+B\+U\+SY} 

T\+I\+N\+Y\+\_\+\+N\+O\+\_\+\+E\+R\+R\+OR 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+O\+U\+T\+\_\+\+O\+F\+\_\+\+S\+Y\+NC -\/ if first byte received from the channel is not packet marker. You may ignore this error. T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+D\+A\+T\+A\+\_\+\+T\+O\+O\+\_\+\+L\+A\+R\+GE -\/ if incoming packet is too large to fit the buffer T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+F\+A\+I\+L\+ED -\/ if something wrong with received data T\+I\+N\+Y\+\_\+\+B\+U\+SY -\/ if another receive operation is in progress. T\+I\+N\+Y\+\_\+\+S\+U\+C\+C\+E\+SS -\/ if nothing is received. greater 0 -\/ number of received bytes. Callbak will be called in this case. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
do not use blocking send (tiny\+\_\+send\+\_\+wait\+\_\+ack) in on\+\_\+frame\+\_\+cb\+\_\+t callback. 
\end{DoxyWarning}
\mbox{\Hypertarget{group__HALF__DUPLEX__API_ga84325cc961c3f31e2ba6111d0235bd61}\label{group__HALF__DUPLEX__API_ga84325cc961c3f31e2ba6111d0235bd61}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!tiny\+\_\+hd\+\_\+run\+\_\+tx@{tiny\+\_\+hd\+\_\+run\+\_\+tx}}
\index{tiny\+\_\+hd\+\_\+run\+\_\+tx@{tiny\+\_\+hd\+\_\+run\+\_\+tx}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{tiny\+\_\+hd\+\_\+run\+\_\+tx()}{tiny\_hd\_run\_tx()}}
{\footnotesize\ttfamily int tiny\+\_\+hd\+\_\+run\+\_\+tx (\begin{DoxyParamCaption}\item[{\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$}]{handle }\end{DoxyParamCaption})}

Use this function for multithread mode, when you need to run tx in separate thread.


\begin{DoxyParams}{Parameters}
{\em handle} & -\/ pointer to S\+Tiny\+Hd\+Data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+F\+A\+I\+L\+ED -\/ if something wrong with received data T\+I\+N\+Y\+\_\+\+S\+U\+C\+C\+E\+SS -\/ if nothing is received. 
\end{DoxyReturn}
\mbox{\Hypertarget{group__HALF__DUPLEX__API_ga5aad8dcb504b80bac923496f2686a6d6}\label{group__HALF__DUPLEX__API_ga5aad8dcb504b80bac923496f2686a6d6}} 
\index{Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}!tiny\+\_\+send\+\_\+wait\+\_\+ack@{tiny\+\_\+send\+\_\+wait\+\_\+ack}}
\index{tiny\+\_\+send\+\_\+wait\+\_\+ack@{tiny\+\_\+send\+\_\+wait\+\_\+ack}!Tiny Half Duplex A\+P\+I functions@{Tiny Half Duplex A\+P\+I functions}}
\subsubsection{\texorpdfstring{tiny\+\_\+send\+\_\+wait\+\_\+ack()}{tiny\_send\_wait\_ack()}}
{\footnotesize\ttfamily int tiny\+\_\+send\+\_\+wait\+\_\+ack (\begin{DoxyParamCaption}\item[{\hyperlink{group__HALF__DUPLEX__API_gaf9f81ad129b754a780dfca5dcd7f7cf9}{S\+Tiny\+Hd\+Data} $\ast$}]{handle,  }\item[{void $\ast$}]{buf,  }\item[{uint16\+\_\+t}]{len }\end{DoxyParamCaption})}



Sends userdata and waits for acknowledgement from remote side. 

Sends userdata and waits for acknowledgement from remote side.

\begin{DoxyRemark}{Remarks}
Each outoing packet is assigned 16-\/bit uid, and remote side must confirm with service packet sent back with this 16-\/bit uid. Generated uids have range in \mbox{[}0 \+: 0x0\+F\+FF\mbox{]}. Higher 4 bits of uid field are used to pass flags with the packet.
\end{DoxyRemark}

\begin{DoxyParams}{Parameters}
{\em handle} & -\/ pointer to S\+Tiny\+Hd\+Data \\
\hline
{\em buf} & -\/ data to send \\
\hline
{\em len} & -\/ length of data to send\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bytes, sent. T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+T\+I\+M\+E\+O\+UT -\/ if no response from remote side after 3 retries. T\+I\+N\+Y\+\_\+\+E\+R\+R\+\_\+\+F\+A\+I\+L\+ED -\/ if request was cancelled, by \hyperlink{group__HALF__DUPLEX__API_ga275846730a88b9654345d5defbda31e7}{tiny\+\_\+hd\+\_\+close()}. other error codes -\/ if send/receive errors happened. 
\end{DoxyReturn}
